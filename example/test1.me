
import "example1";
import "WDict";
var @p;

def processbar:
{
	var $i = 0;
	while($i<100){
		MIo.Out("*");
		$i = $i+1;
	}
	$i = 0;
	while($i<100){
		MIo.Out("\b");
		$i = $i+1;
	}
}

def openfilecallback:$msg
{
	MIo.Out($msg);
}

def playercallback:
{
	
	while(true){
		if(example1.GetStatus(@p)==0){			
			break;
		}
		var $info = example1.GetPosition(@p);
		MIo.Out($info::Hour + ":" + $info::Minute + ":" + $info::Second+  "\r");
	}
	example1.Release(@p);
	MIo.Out("\r\nplay end\r\n");
	processbar();
}

_wmain:$a,$c
{	
	MIo.Out("文件地址:");
	$a = MIo.In();
	processbar();
	@p = example1.CreatePlay();
	if(!example1.OpenFile(@p,$a,openfilecallback))
	{
		return;
	}
	MIo.Out("正在播放:"+$a+"\r\n");
	var $info = example1.GetStreamInfo(@p);
	MIo.Out("总时长:"+$info::Hour + ":" + $info::Minute + ":" + $info::Second+ "\r\n");
	example1.Play2(@p);
	playercallback();
	
	return;
}
